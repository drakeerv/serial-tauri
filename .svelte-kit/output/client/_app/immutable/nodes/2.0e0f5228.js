import{s as he,n as F,r as de,b as G,f as ye,o as ke}from"../chunks/scheduler.b95eede2.js";import{S as _e,i as pe,g,s as B,h as w,j as P,c as H,f as p,k as _,a as N,x as m,y as V,z as ve,e as se,m as Q,n as X,o as Y,r as Ce,A as q,u as Ee,B as M,C as re,v as Pe,D as me,d as Le,t as Oe,w as xe,E as Te}from"../chunks/index.85ecae09.js";function z(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}var Ne=Object.defineProperty,De=(l,e)=>{for(var t in e)Ne(l,t,{get:e[t],enumerable:!0})},ge=(l,e,t)=>{if(!e.has(l))throw TypeError("Cannot "+t)},ie=(l,e,t)=>(ge(l,e,"read from private field"),t?t.call(l):e.get(l)),Ve=(l,e,t)=>{if(e.has(l))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(l):e.set(l,t)},Re=(l,e,t,r)=>(ge(l,e,"write to private field"),r?r.call(l,t):e.set(l,t),t),Se={};De(Se,{Channel:()=>we,PluginListener:()=>be,addPluginListener:()=>Ae,convertFileSrc:()=>Ue,invoke:()=>A,transformCallback:()=>J});function je(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function J(l,e=!1){let t=je(),r=`_${t}`;return Object.defineProperty(window,r,{value:s=>(e&&Reflect.deleteProperty(window,r),l==null?void 0:l(s)),writable:!1,configurable:!0}),t}var $,we=class{constructor(){this.__TAURI_CHANNEL_MARKER__=!0,Ve(this,$,()=>{}),this.id=J(l=>{ie(this,$).call(this,l)})}set onmessage(l){Re(this,$,l)}get onmessage(){return ie(this,$)}toJSON(){return`__CHANNEL__:${this.id}`}};$=new WeakMap;var be=class{constructor(l,e,t){this.plugin=l,this.event=e,this.channelId=t}async unregister(){return A(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}};async function Ae(l,e,t){let r=new we;return r.onmessage=t,A(`plugin:${l}|register_listener`,{event:e,handler:r}).then(()=>new be(l,e,r.id))}async function A(l,e={},t){return new Promise((r,s)=>{let n=J(a=>{r(a),Reflect.deleteProperty(window,`_${i}`)},!0),i=J(a=>{s(a),Reflect.deleteProperty(window,`_${n}`)},!0);window.__TAURI_IPC__({cmd:l,callback:n,error:i,payload:e,options:t})})}function Ue(l,e="asset"){return window.__TAURI__.convertFileSrc(l,e)}function oe(l,e,t){const r=l.slice();return r[18]=e[t],r}function Be(l){let e,t=l[18].content+"",r;return{c(){e=g("div"),r=Q(t),this.h()},l(s){e=w(s,"DIV",{class:!0});var n=P(e);r=X(n,t),n.forEach(p),this.h()},h(){_(e,"class","text-green-400 break-words")},m(s,n){N(s,e,n),m(e,r)},p(s,n){n&16&&t!==(t=s[18].content+"")&&Y(r,t)},d(s){s&&p(e)}}}function He(l){let e,t=l[18].content+"",r;return{c(){e=g("div"),r=Q(t),this.h()},l(s){e=w(s,"DIV",{class:!0});var n=P(e);r=X(n,t),n.forEach(p),this.h()},h(){_(e,"class","text-white break-words")},m(s,n){N(s,e,n),m(e,r)},p(s,n){n&16&&t!==(t=s[18].content+"")&&Y(r,t)},d(s){s&&p(e)}}}function ae(l){let e;function t(n,i){if(n[18].type==n[5].Input)return He;if(n[18].type==n[5].Output)return Be}let r=t(l),s=r&&r(l);return{c(){s&&s.c(),e=se()},l(n){s&&s.l(n),e=se()},m(n,i){s&&s.m(n,i),N(n,e,i)},p(n,i){r===(r=t(n))&&s?s.p(n,i):(s&&s.d(1),s=r&&r(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){n&&p(e),s&&s.d(n)}}}function ce(l){let e,t,r;return{c(){e=g("input"),this.h()},l(s){e=w(s,"INPUT",{type:!0,class:!0,id:!0}),this.h()},h(){_(e,"type","text"),_(e,"class","bg-gray-900 text-white svelte-17239dh"),_(e,"id","input")},m(s,n){N(s,e,n),l[13](e),t||(r=V(e,"keydown",l[6]),t=!0)},p:F,d(s){s&&p(e),l[13](null),t=!1,r()}}}function $e(l){let e,t,r,s,n=z(l[4]),i=[];for(let o=0;o<n.length;o+=1)i[o]=ae(oe(l,n,o));let a=l[0]&&ce(l);return{c(){e=g("div");for(let o=0;o<i.length;o+=1)i[o].c();t=B(),a&&a.c(),this.h()},l(o){e=w(o,"DIV",{class:!0,id:!0});var c=P(e);for(let f=0;f<i.length;f+=1)i[f].l(c);t=H(c),a&&a.l(c),c.forEach(p),this.h()},h(){_(e,"class","flex flex-col bg-gray-900 text-2xl h-full overflow-y-scroll overflow-x-hidden svelte-17239dh"),_(e,"id","terminal")},m(o,c){N(o,e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null);m(e,t),a&&a.m(e,null),l[14](e),r||(s=[V(e,"click",l[1]),V(e,"scroll",l[7])],r=!0)},p(o,[c]){if(c&48){n=z(o[4]);let f;for(f=0;f<n.length;f+=1){const I=oe(o,n,f);i[f]?i[f].p(I,c):(i[f]=ae(I),i[f].c(),i[f].m(e,t))}for(;f<i.length;f+=1)i[f].d(1);i.length=n.length}o[0]?a?a.p(o,c):(a=ce(o),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:F,o:F,d(o){o&&p(e),ve(i,o),a&&a.d(),l[14](null),r=!1,de(s)}}}function Me(l,e,t){let{allowInput:r=!1}=e,s,n,i=[],a=!0;var o=(h=>(h[h.Input=0]="Input",h[h.Output=1]="Output",h))(o||{});let c=[];function f(){s==null||s.focus()}function I(h){t(4,c=[...c,h]),a&&t(3,n.scrollTop=n.scrollHeight,n)}function R(h){I({type:1,content:h})}function L(h){I({type:0,content:h})}function E(){t(4,c=[])}function S(){t(2,s.value="",s)}function j(h){i=[...i,h]}function x(h){if(h.key=="Enter"){const T=s.value;L(T),S(),i.forEach(v=>{v(T)})}}function d(){a=n.scrollTop+n.clientHeight>=n.scrollHeight}function C(h){G[h?"unshift":"push"](()=>{s=h,t(2,s)})}function D(h){G[h?"unshift":"push"](()=>{n=h,t(3,n)})}return l.$$set=h=>{"allowInput"in h&&t(0,r=h.allowInput)},[r,f,s,n,c,o,x,d,R,L,E,S,j,C,D]}class Fe extends _e{constructor(e){super(),pe(this,e,Me,$e,he,{allowInput:0,focusInput:1,addOutputLine:8,addInputLine:9,clearLines:10,clearInput:11,addInputListener:12})}get focusInput(){return this.$$.ctx[1]}get addOutputLine(){return this.$$.ctx[8]}get addInputLine(){return this.$$.ctx[9]}get clearLines(){return this.$$.ctx[10]}get clearInput(){return this.$$.ctx[11]}get addInputListener(){return this.$$.ctx[12]}}function ue(l,e,t){const r=l.slice();return r[16]=e[t],r}function fe(l){let e,t=l[16]+"",r,s;return{c(){e=g("option"),r=Q(t),this.h()},l(n){e=w(n,"OPTION",{});var i=P(e);r=X(i,t),i.forEach(p),this.h()},h(){e.__value=s=l[16],M(e,e.__value)},m(n,i){N(n,e,i),m(e,r)},p(n,i){i&1&&t!==(t=n[16]+"")&&Y(r,t),i&1&&s!==(s=n[16])&&(e.__value=s,M(e,e.__value))},d(n){n&&p(e)}}}function We(l){let e,t="Open",r,s;return{c(){e=g("button"),e.textContent=t,this.h()},l(n){e=w(n,"BUTTON",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-1ulfnmy"&&(e.textContent=t),this.h()},h(){_(e,"class","bg-gray-900 text-white")},m(n,i){N(n,e,i),r||(s=V(e,"click",l[10]),r=!0)},p:F,d(n){n&&p(e),r=!1,s()}}}function qe(l){let e,t="Close",r,s;return{c(){e=g("button"),e.textContent=t,this.h()},l(n){e=w(n,"BUTTON",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-o0bcgt"&&(e.textContent=t),this.h()},h(){_(e,"class","bg-gray-900 text-white")},m(n,i){N(n,e,i),r||(s=V(e,"click",l[9]),r=!0)},p:F,d(n){n&&p(e),r=!1,s()}}}function ze(l){let e,t,r,s,n,i="Select a port",a,o,c,f,I,R,L,E,S="Clear",j,x,d,C,D,h,T=z(l[0]),v=[];for(let u=0;u<T.length;u+=1)v[u]=fe(ue(l,T,u));function Z(u,k){return u[1]?qe:We}let W=Z(l),O=W(l),Ie={allowInput:l[1]};return d=new Fe({props:Ie}),l[12](d),{c(){e=g("div"),t=g("div"),r=g("div"),s=g("select"),n=g("option"),n.textContent=i;for(let u=0;u<v.length;u+=1)v[u].c();a=B(),o=g("div"),c=g("input"),f=B(),I=g("div"),O.c(),R=B(),L=g("div"),E=g("button"),E.textContent=S,j=B(),x=g("div"),Ce(d.$$.fragment),this.h()},l(u){e=w(u,"DIV",{class:!0});var k=P(e);t=w(k,"DIV",{class:!0});var b=P(t);r=w(b,"DIV",{class:!0});var y=P(r);s=w(y,"SELECT",{class:!0});var U=P(s);n=w(U,"OPTION",{"data-svelte-h":!0}),q(n)!=="svelte-b0iee1"&&(n.textContent=i);for(let K=0;K<v.length;K+=1)v[K].l(U);U.forEach(p),y.forEach(p),a=H(b),o=w(b,"DIV",{class:!0});var ee=P(o);c=w(ee,"INPUT",{class:!0,type:!0,placeholder:!0,min:!0,step:!0}),ee.forEach(p),f=H(b),I=w(b,"DIV",{class:!0});var te=P(I);O.l(te),te.forEach(p),R=H(b),L=w(b,"DIV",{class:!0});var ne=P(L);E=w(ne,"BUTTON",{class:!0,"data-svelte-h":!0}),q(E)!=="svelte-511dyv"&&(E.textContent=S),ne.forEach(p),b.forEach(p),j=H(k),x=w(k,"DIV",{class:!0});var le=P(x);Ee(d.$$.fragment,le),le.forEach(p),k.forEach(p),this.h()},h(){n.disabled=!0,n.selected=!0,n.__value="",M(n,n.__value),_(s,"class","bg-gray-900 text-white"),l[3]===void 0&&ye(()=>l[7].call(s)),_(r,"class","flex-none w-1/4 flex items-center justify-center"),_(c,"class","bg-gray-900 text-white"),_(c,"type","number"),_(c,"placeholder","Baud rate"),_(c,"min","0"),_(c,"step","1"),_(o,"class","flex-none w-1/4 flex items-center justify-center"),_(I,"class","flex-none w-1/4 flex items-center justify-center"),_(E,"class","bg-gray-900 text-white"),_(L,"class","flex-none w-1/4 flex items-center justify-center"),_(t,"class","flex-none h-12 bg-gray-600 text-white flex items-center justify-center"),_(x,"class","flex-grow bg-gray-900 text-white"),_(e,"class","flex flex-col h-screen")},m(u,k){N(u,e,k),m(e,t),m(t,r),m(r,s),m(s,n);for(let b=0;b<v.length;b+=1)v[b]&&v[b].m(s,null);re(s,l[3],!0),m(t,a),m(t,o),m(o,c),M(c,l[4]),m(t,f),m(t,I),O.m(I,null),m(t,R),m(t,L),m(L,E),m(e,j),m(e,x),Pe(d,x,null),C=!0,D||(h=[V(s,"change",l[7]),V(c,"input",l[8]),V(E,"click",l[11])],D=!0)},p(u,[k]){if(k&1){T=z(u[0]);let y;for(y=0;y<T.length;y+=1){const U=ue(u,T,y);v[y]?v[y].p(U,k):(v[y]=fe(U),v[y].c(),v[y].m(s,null))}for(;y<v.length;y+=1)v[y].d(1);v.length=T.length}k&9&&re(s,u[3]),k&16&&me(c.value)!==u[4]&&M(c,u[4]),W===(W=Z(u))&&O?O.p(u,k):(O.d(1),O=W(u),O&&(O.c(),O.m(I,null)));const b={};k&2&&(b.allowInput=u[1]),d.$set(b)},i(u){C||(Le(d.$$.fragment,u),C=!0)},o(u){Oe(d.$$.fragment,u),C=!1},d(u){u&&p(e),ve(v,u),O.d(),l[12](null),xe(d),D=!1,de(h)}}}function Je(l,e,t){let r=[],s=!1,n,i="",a=9600;function o(){A("list_ports").then(d=>{const C=d;C.includes(i)||(t(3,i=""),t(1,s=!1)),t(0,r=C)})}function c(d,C){A("open_port",{portName:d,baudRate:C}).then(D=>{t(1,s=!0),n.focusInput()}).catch(D=>{console.log(D)})}function f(){A("close_port").then(d=>{t(1,s=!1)})}function I(d){A("write_data",{data:d}).then(C=>{console.log(C)})}ke(()=>{setInterval(()=>{o()},1e3),n.addInputListener(d=>{I(d)})});function R(){i=Te(this),t(3,i),t(0,r)}function L(){a=me(this.value),t(4,a)}const E=()=>f(),S=()=>c(i,a),j=()=>n.clearLines();function x(d){G[d?"unshift":"push"](()=>{n=d,t(2,n)})}return[r,s,n,i,a,c,f,R,L,E,S,j,x]}class Qe extends _e{constructor(e){super(),pe(this,e,Je,ze,he,{})}}export{Qe as component};
